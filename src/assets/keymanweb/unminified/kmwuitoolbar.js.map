{"version":3,"file":"kmwuitoolbar.js","sourceRoot":"","sources":["../source/kmwuitoolbar.ts"],"names":[],"mappings":"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","sourcesContent":["/***\r\n   KeymanWeb 11.0\r\n   Copyright 2019 SIL International\r\n***/\r\n\r\n// If a UI module has been loaded, we can rely on the publically-published 'name' property\r\n// having been set as a way to short-out a UI reload.  Its parent object always exists by\r\n// this point in the build process.\r\nif(!window['keyman']['ui']['name']) { \r\n  /********************************/\r\n  /*                              */\r\n  /* Toolbar User Interface       */\r\n  /*                              */\r\n  /********************************/\r\n\r\n  /**\r\n   * Do not enclose in an anonymous function, as the compiler may create\r\n   * global scope variables to replace true, false, null, which can collide\r\n   * with other variables.\r\n   * Instead, use the --output-wrapper command during optimization, which will\r\n   * add the anonymous function to enclose all code, including those optimized\r\n   * variables which would otherwise have global scope.\r\n   **/  \r\n\r\n  try {\r\n\r\n    // Declare KeymanWeb, OnScreen keyboard and Util objects\r\n    var keymanweb=window['keyman'],osk=keymanweb['osk'],util=keymanweb['util'],dbg=keymanweb['debug'];\r\n\r\n    // Disable UI for touch devices\r\n    if(util['isTouchDevice']()) throw '';\r\n    \r\n    // User interface local variables\r\n    keymanweb['ui'] = {\r\n      init: false,\r\n      toolbarNode: null,\r\n      backgroundNode: null, \r\n      browseMapNode: null, \r\n      keyboardsButtonNode: null,\r\n      languageButtonsNode: null, \r\n      offButtonNode: null, \r\n      offBarNode: null, \r\n      oskButtonNode: null, \r\n      oskBarNode: null,\r\n      selectorNode: null, \r\n      regionLanguageListNodes: [], \r\n      regionNodes: null, \r\n      langKeyboardNodes: [],\r\n      langKeyboardListNodes: [],\r\n      selectedRegion: 'as',\r\n      listedKeyboards: [],\r\n      keyboardListPriority: 0,\r\n      maxListedKeyboards: 1,\r\n      lastActiveControl: null,\r\n      selectedKeyboard: null,\r\n      selectedLanguage: '',\r\n      helpOffsetX: 0,\r\n      helpOffsetY: 0,\r\n      languages: [],      // array of objects { id: <langid>, name: <name>, keyboards: <array of KeymanWeb keyboards> }\r\n      updateMap: false,   // flag to control re-initialization of keyboard map\r\n      startTimer: 0,      // initialization timer - wait 2 seconds after last stub installed then initialize map\r\n      lgText: ''          // language name in toolbar\r\n    }\r\n\r\n    // User Interface object \r\n    var ui=keymanweb['ui'];\r\n    ui['name'] = 'toolbar';\r\n    \r\n    ui.ToolBar_Text = {\r\n      Keyboards: 'Languages',\r\n      OffTitle: 'Turn off KeymanWeb keyboards',\r\n      Off: 'Off',\r\n      ShowOSK: 'Show On Screen Keyboard',\r\n      LanguageSelector: 'Select language'\r\n      };\r\n    \r\n    ui.ToolBar_Text['SelectKeyboardPre']='Select ';\r\n    ui.ToolBar_Text['SelectKeyboardSuf']='keyboard';\r\n    ui.ToolBar_Text['AltKeyboardsPre']='Alternate keyboards for ';\r\n    ui.ToolBar_Text['AltKeyboardsSuf']='';\r\n    \r\n    ui.ToolBar_Text['ca']='Central America';\r\n    ui.ToolBar_Text['sa']='South America';\r\n    ui.ToolBar_Text['na']='North America';\r\n    ui.ToolBar_Text['eu']='Europe';\r\n    ui.ToolBar_Text['af']='Africa';\r\n    ui.ToolBar_Text['me']='Middle east';\r\n    ui.ToolBar_Text['as']='Asia';\r\n    ui.ToolBar_Text['oc']='Oceania';\r\n\r\n\r\n    var controller=document.getElementById('KeymanWebControl');        \r\n  /**\r\n     * Create some of the controls but don't insert them into the document yet\r\n     * This does not need or want to prevent loss of focus, so uses document.createElement\r\n     * rather than util.createElement.      \r\n     * \r\n     * @param       {string}  tag\r\n     * @param       {?string=}  id\r\n     * @param       {?string=}  className\r\n     * @param       {string=}  innerHTML               \r\n     * @return      {Node|null}   \r\n     */       \r\n    ui.createNode = function(tag, id, className, innerHTML)\r\n    {\r\n      //var node = util['createElement'](tag);\r\n      var node = document.createElement(tag);\r\n      if(id) node.id = id;\r\n      if(className) node.className = className;\r\n      if(innerHTML) node.innerHTML = innerHTML;\r\n      \r\n      // The following is OK for IE and for F3.5 and later - should simply be ignored for others\r\n      // first tried preventDefault() as suggested by many on web, which worked but interfered with keyboard and OSK enabling        \r\n      if(tag == 'a' || tag == 'area' || tag == 'map') node.ondragstart = function(){return false;}\r\n      return node;\r\n    }\r\n    \r\n    /**\r\n     * Initialize toolbar UI\r\n     */       \r\n    ui['initialize'] = ui.initToolbarUI = function()\r\n    {\r\n      if(!keymanweb['initialized'] || ui.init) return;\r\n    \r\n      // Find the controller DIV, insert at top of body if undefined\r\n      var e = document.getElementById('KeymanWebControl');    \r\n      if(!e) \r\n      {\r\n        if(document.body == null)\r\n          return;\r\n        else\r\n        {\r\n          e=document.createElement('DIV');\r\n          e.id='KeymanWebControl';  \r\n          document.body.insertBefore(e,document.body.firstChild);\r\n          ui._insertedElem = e;\r\n        }\r\n      }\r\n      \r\n      // Hide toolbar until elements fully drawn, to prevent spurious text displays\r\n      e.style.visibility='hidden'; e.style.maxHeight='35px';\r\n\r\n      ui.init = true;\r\n      \r\n      if(util['isTouchDevice']()) return;\r\n\r\n      util['linkStyleSheet'](util['getOption']('resources')+'ui/toolbar/kmwuitoolbar.css');\r\n        \r\n      ui.regions = {};\r\n      ui.regions['ca'] = {t: ui.ToolBar_Text['ca'], m: '49,52,65,54,68,57,71,56,73,59,75,60,93,61,94,58,97,58,101,59,107,60,114,64,115,68,114,77,104,74,98,75,96,78,95,82,90,81,85,80,82,76,78,74,74,73,65,68,57,61' },\r\n      ui.regions['sa'] = {t: ui.ToolBar_Text['sa'], m: '82,82,95,82,96,78,98,75,104,74,114,77,120,79,124,83,126,87,141,90,142,97,138,103,135,113,127,116,123,124,115,131,112,132,109,138,117,139,140,141,141,146,134,148,114,145,109,148,100,148,91,143,91,130,96,111,89,102,83,95,77,89' },\r\n      ui.regions['na'] = {t: ui.ToolBar_Text['na'], m: '0,3,0,37,24,32,35,37,43,47,49,52,65,54,68,57,71,56,73,59,75,60,93,61,93,57,103,49,118,41,126,41,136,23,148,17,156,14,164,5,164,0,57,0,35,5,25,9,5,8' },\r\n      ui.regions['eu'] = {t: ui.ToolBar_Text['eu'], m: '145,29,146,19,158,14,171,6,187,2,206,1,217,4,227,11,231,16,231,33,227,34,225,35,225,37,227,39,228,44,228,47,227,48,223,46,218,44,215,43,208,43,203,45,202,48,205,52,201,52,195,49,189,50,187,48,177,48,175,49,166,50,147,33' },\r\n      ui.regions['af'] = {t: ui.ToolBar_Text['af'], m: '150,58,158,50,166,50,175,49,177,48,187,48,189,50,195,49,201,52,205,52,207,53,221,75,229,75,231,77,231,85,227,92,232,101,237,106,237,112,227,115,222,118,206,125,199,127,193,127,185,111,183,104,180,87,168,89,153,85,143,71,147,60' },\r\n      ui.regions['me'] = {t: ui.ToolBar_Text['me'], m: '205,52,202,48,203,45,208,43,215,43,218,44,223,46,227,48,232,48,239,48,240,49,239,53,242,60,243,65,237,76,231,77,229,75,221,75,207,53' },\r\n      ui.regions['as'] = {t: ui.ToolBar_Text['as'], m: '219,1,221,6,228,12,231,16,231,33,227,34,225,35,225,37,227,39,229,45,232,48,239,48,240,49,239,53,242,60,243,65,249,70,252,81,259,87,271,87,278,95,289,100,303,101,311,98,320,98,323,98,323,84,311,81,308,73,307,65,317,57,330,50,334,44,348,36,364,38,375,34,375,8,355,8,336,5,292,1,285,0,219,0' },\r\n      ui.regions['oc'] = {t: ui.ToolBar_Text['oc'], m: '288,117,289,107,303,101,311,98,323,98,323,84,333,77,344,73,362,80,369,88,375,96,375,141,352,143,323,142,316,136,310,130,291,130' }\r\n      \r\n      ui.toolbarNode = ui.createNode('div', 'kmw_controls');\r\n      ui.toolbarNode.style.display='block';\r\n      \r\n      var tbNode = ui.createNode('a', 'kmw_controls_start', null, ' '); \r\n      tbNode.href = \"https://keyman.com/developer/keymanweb/\";\r\n      tbNode.target=\"_blank\";\r\n      ui.toolbarNode.appendChild(tbNode);\r\n      \r\n      /* Keyboards button */\r\n      ui.keyboardsButtonNode = ui.createNode('div','kmw_btn_keyboards','kmw_button');\r\n      ui.keyboardsButtonNode.title=ui.ToolBar_Text.LanguageSelector;\r\n      var aNode = ui.createNode('a', null, 'kmw_button_a');\r\n      aNode.href='#';\r\n      aNode.onclick = ui.showKeyboardsPopup;\r\n      aNode.appendChild(ui.createNode('div', 'kmw_img_keyboards', 'kmw_img'));\r\n      aNode.appendChild(ui.createNode('div', null, 'kmw_a', ui.ToolBar_Text.Keyboards));\r\n      aNode.appendChild(ui.createNode('div', null, 'kmw_drop'));\r\n      ui.keyboardsButtonNode.appendChild(aNode);\r\n\r\n      /* Keyboards popup */\r\n      ui.selectorNode = ui.createNode('div', 'kmw_selector');\r\n      ui.regionsNode = ui.createNode('div', 'kmw_selector_regions');    \r\n      var imgNode;\r\n      ui.browseMapNode = ui.createNode('div', 'kmw_browsemap');\r\n      imgNode = ui.createNode('img', 'kmw_region_browsemap');\r\n      imgNode.src= util['getOption']('resources')+'ui/toolbar/blank.gif';\r\n      imgNode.useMap = '#kmw_worldgrey16';\r\n      ui.browseMapNode.appendChild(imgNode);\r\n    \r\n      var areaNode, mapNode = ui.createNode('map', 'kmw_worldgrey16');\r\n      mapNode.name='kmw_worldgrey16';\r\n      for(var i in ui.regions)\r\n      {\r\n        areaNode = ui.createNode('area');\r\n        areaNode.shape = 'poly';\r\n        areaNode.alt = '';\r\n        areaNode.href = '#';\r\n        areaNode.title = ui.regions[i].t;\r\n        areaNode.hidefocus = 'true';\r\n        areaNode.onclick = (function(i) { return function(event) { return ui.selectRegion(event, i); } })(i);\r\n        areaNode.onmouseover = (function(i) { return function(event) { return ui.hoverRegion(event, i); } })(i);\r\n        areaNode.onmouseout = (function(i) { return function(event) { return ui.unhoverRegion(event, i); } })(i);\r\n        areaNode.coords = ui.regions[i].m;\r\n        mapNode.appendChild(areaNode);\r\n      }\r\n      \r\n      areaNode = ui.createNode('area');\r\n      areaNode.shape = 'default';\r\n      areaNode.nohref = 'true';\r\n      areaNode.alt = '';\r\n      areaNode.onclick=ui.eventCapture;   // do not close map when clicking on ocean!\r\n      mapNode.appendChild(areaNode);\r\n      ui.browseMapNode.appendChild(mapNode);\r\n      ui.regionsNode.appendChild(ui.browseMapNode);\r\n      ui.regionNodes = {};\r\n\r\n      var listNode = ui.createNode('ul');\r\n      for(i in ui.regions)\r\n      {\r\n        var itemNode = ui.createNode('li');\r\n        ui.regionNodes[i] = ui.createNode('a', null, null, ui.regions[i].t);\r\n        ui.regionNodes[i].href='#';\r\n        ui.regionNodes[i].onclick = (function(i) { return function(event) { return ui.selectRegion(event, i); } })(i);\r\n        ui.regionNodes[i].onmouseover = (function(i) { return function(event) { return ui.hoverRegion(event, i); } })(i);\r\n        ui.regionNodes[i].onmouseout = (function(i) { return function(event) { return ui.unhoverRegion(event, i); } })(i);\r\n        itemNode.appendChild(ui.regionNodes[i]);\r\n        listNode.appendChild(itemNode);\r\n      }\r\n      ui.regionsNode.appendChild(listNode);    \r\n      ui.selectorNode.appendChild(ui.regionsNode);\r\n      ui.keyboardsButtonNode.appendChild(ui.selectorNode);\r\n      ui.toolbarNode.appendChild(ui.keyboardsButtonNode);\r\n\r\n      // Separator and Keyboard Off Button       \r\n      ui.toolbarNode.appendChild(ui.offBarNode = ui.createNode('div', 'kmw_bar_off', 'kmw_bar'));\r\n  \r\n      ui.offButtonNode = ui.createNode('div', 'kmw_btn_off', 'kmw_button_selected');\r\n      aNode = ui.createNode('a', null, 'kmw_button_a');\r\n      aNode.href = '#';\r\n      aNode.onclick = ui.offButtonClickEvent;\r\n      aNode.title = ui.ToolBar_Text.OffTitle;\r\n      aNode.appendChild(ui.createNode('div', 'kmw_img_off', 'kmw_img'));\r\n      aNode.appendChild(ui.createNode('div', null, 'kmw_a', ui.ToolBar_Text.Off));\r\n      ui.offButtonNode.appendChild(aNode);\r\n      ui.toolbarNode.appendChild(ui.offButtonNode);\r\n      \r\n      // Keyboard buttons       \r\n      ui.toolbarNode.appendChild(ui.languageButtonsNode = ui.createNode('div', 'kmw_control_keyboards', 'kmw_button'));    \r\n      \r\n      // Separator and On Screen Keyboard Button       \r\n      ui.toolbarNode.appendChild(ui.oskBarNode = ui.createNode('div', 'kmw_bar_osk', 'kmw_bar'));\r\n        \r\n      ui.oskButtonNode = ui.createNode('div', 'kmw_btn_osk', 'kmw_button');//was 'kmw_button_selected'\r\n      aNode = ui.createNode('a', null, 'kmw_button_a');\r\n      aNode.href = '#';\r\n      aNode.onclick = ui.showOSK;\r\n      aNode.title = ui.ToolBar_Text.ShowOSK;\r\n      aNode.appendChild(ui.createNode('div', 'kmw_img_osk', 'kmw_img'));\r\n      //aNode.appendChild(ui.createNode('div', null, 'kmw_a', 'On Screen Keyboard'));\r\n      ui.oskButtonNode.appendChild(aNode);\r\n      ui.toolbarNode.appendChild(ui.oskButtonNode);\r\n    \r\n      ui.toolbarNode.appendChild(ui.createNode('div', 'kmw_controls_end', null, ' '));\r\n    \r\n      var img = ui.createNode('div');\r\n      img.id = 'kmw_map_preload';\r\n      ui.toolbarNode.appendChild(img);\r\n    \r\n      ui.toolbarNode.appendChild(ui.createNode('br', null, 'kmw_clear'));\r\n    \r\n      // Append toolbar node to controller      \r\n      e.appendChild(ui.toolbarNode);    \r\n    \r\n      // Initialize map array, using a timer to allow restarting if necessary after keyboards loaded\r\n      // Note that toolbar will be displayed and enabled on completion of timeout routine\r\n      ui.updateMap = true;\r\n      if(ui.startTimer) clearTimeout(ui.startTimer);\r\n      ui.startTimer = setTimeout(ui.addKeyboardsToMap,2000);\r\n    \r\n      // Ensure that popups are hidden by clicking elsewhere on document\r\n      util['attachDOMEvent'](document.body,'click',ui.hideAllPopups,false);\r\n\r\n      // Set Europe to be the default region \r\n      ui.selectedRegion = 'eu';\r\n\r\n      // Restore focus\r\n      keymanweb['focusLastActiveElement']();  \r\n    }\r\n\r\n    ui.shutdown = function() {\r\n      var root = ui.toolbarNode;\r\n      if(root) {\r\n        root.parentNode.removeChild(root);\r\n      }\r\n\r\n      root = ui._insertedElem;\r\n      if(root) {\r\n        root.parentNode.removeChild(root);\r\n      }\r\n    }\r\n\r\n    /**\r\n     * Fill the map with available keyboards when the Keyboards selector is clicked\r\n     *    after all keyboard stubs have been registered\r\n    **/     \r\n    ui.addKeyboardsToMap = function()\r\n    {\r\n      // Do nothing unless a keyboard has been installed since map created\r\n      if(ui.updateMap) ui.updateMap=false; else return;\r\n\r\n      var n = 0;  \r\n      ui.regionLanguageListNodes = {};\r\n    \r\n      // Build list of keyboards by region and language       \r\n      var Keyboards = keymanweb['getKeyboards']();\r\n      \r\n      // Sort the keyboards by region and language\r\n      Keyboards.sort(ui.sortKeyboards);\r\n\r\n      // Always rebuild the map, so remove any previously created language lists \r\n      for(n=ui.regionsNode.childNodes.length; n>0; n--)\r\n      {\r\n        if(ui.regionsNode.childNodes[n-1].className == 'kmw_selector_region')\r\n        {\r\n          ui.regionsNode.removeChild(ui.regionsNode.childNodes[n-1]);\r\n        }\r\n      }\r\n      \r\n      for(var i in ui.regions)\r\n      {      \r\n      \r\n        ui.regionLanguageListNodes[i] = ui.createNode('div', null, 'kmw_selector_region');\r\n        var colNode = ui.createNode('div', null, 'kmw_keyboard_col');\r\n        var max = 0, count = 0, languageCode = '';\r\n    \r\n        // Get number of languages for the region         \r\n        for(var j=0; j<Keyboards.length; j++)\r\n        {         \r\n          if(Keyboards[j]['RegionCode'] != i) continue;              // Not this region\r\n\r\n          // Get JUST the language code for this section.  BCP-47 codes can include more!\r\n          var bcpSubtags: string[] = keymanweb['util']['getLanguageCodes'](Keyboards[j]['LanguageCode']);\r\n          if(bcpSubtags[0] == languageCode) continue; // Same language as previous keyboard\r\n          languageCode = bcpSubtags[0];\r\n\r\n          max++;\r\n        }   \r\n        max = Number(((max+3)/4).toFixed(0));   // Get number of entries per column\r\n  \r\n        // Add language list to columns for the region\r\n        languageCode='';\r\n        for(var j=0; j<Keyboards.length; j++)\r\n        {           \r\n          if(Keyboards[j]['RegionCode'] != i) continue;      // Not this region\r\n\r\n          var bcpSubtags: string[] = keymanweb['util']['getLanguageCodes'](Keyboards[j]['LanguageCode']);\r\n          if(bcpSubtags[0] == languageCode) {  // Same language as previous keyboard, so add it to that entry\r\n            var x = ui.languages[languageCode].keyboards;\r\n\r\n            // While we could avoid duplicating keyboard entries that occur for multiple regions, we'll instead\r\n            // allow them to display while distinguishing them more directly.  (That part is handled later.)\r\n            if(x.push) {\r\n              x.push(Keyboards[j]);\r\n            } else {\r\n              ui.languages[languageCode].keyboards = x.concat(Keyboards[j]);\r\n            }\r\n\r\n            continue;\r\n          }\r\n          \r\n          // Add a new language entry          \r\n          languageCode = bcpSubtags[0]; \r\n          ui.languages[languageCode] = { id: Keyboards[j]['LanguageCode'], name: Keyboards[j]['LanguageName'], keyboards: [Keyboards[j]] };\r\n  \r\n          // Start a new column if necessary          \r\n          if(count % max == 0 && count > 0)\r\n          {\r\n            ui.regionLanguageListNodes[i].appendChild(colNode);\r\n            colNode = ui.createNode('div', null, count/max == 3 ? 'kmw_keyboard_col_right' : 'kmw_keyboard_col');   \r\n          }\r\n          count++;\r\n          \r\n          // Add the language to the column          \r\n          var langNode = ui.createNode('div', null, 'kmw_language');\r\n          var aNode = ui.createNode('a', null, null, Keyboards[j]['LanguageName']);\r\n          aNode.href='#';\r\n          aNode.onclick = (function(lang) { return function(event) { return ui.selectLanguage(event, lang); }; })(ui.languages[languageCode]);\r\n          langNode.appendChild(aNode);\r\n          colNode.appendChild(langNode);\r\n          \r\n          n++;\r\n        }\r\n        // Finish the last column and close the list        \r\n        ui.regionLanguageListNodes[i].appendChild(colNode);\r\n        ui.regionLanguageListNodes[i].appendChild(ui.createNode('div', null, 'kmw_clear'));\r\n        ui.regionsNode.appendChild(ui.regionLanguageListNodes[i]);\r\n      }\r\n      ui.loadCookie();\r\n      \r\n      // Ensure that the correct region has been selected\r\n      ui.selectRegion(null, ui.selectedRegion);\r\n      ui.enableControls();  \r\n      \r\n      // Restore focus\r\n      keymanweb['focusLastActiveElement']();\r\n\r\n    }\r\n          \r\n    /**\r\n     * Sort keyboards array returned from keymanweb by region and language\r\n     * \r\n     * @param       {Object}  a\r\n     * @param       {Object}  b\r\n     * @return      {number}   \r\n     **/   \r\n    ui.sortKeyboards = function(a,b)\r\n    {\r\n      if(a['RegionCode'] < b['RegionCode']) return -2;\r\n      if(a['RegionCode'] > b['RegionCode']) return 2;\r\n      if(a['LanguageName'] < b['LanguageName']) return -1;\r\n      if(a['LanguageName'] > b['LanguageName']) return 1;\r\n      return 0;\r\n    }\r\n      \r\n    /* KeymanWeb Interfaces */\r\n\r\n    /**\r\n     * Function     findListedKeyboard\r\n     * Scope        Private\r\n     * @param       {Object}  lang\r\n     * @return      {?number}   \r\n     * Description  Test if a keyboard is still shown on the toolbar.  Returns index of keyboard in listedKeyboards or null if not found\r\n     */\r\n    ui.findListedKeyboard = function(lang)\r\n    {\r\n      for(var i = 0; i < ui.listedKeyboards.length; i++)\r\n        if(ui.listedKeyboards[i].lang.id == lang.id) return i;\r\n      return null;\r\n    }\r\n\r\n    /**\r\n     * Add a keyboard to the list of keyboards available for a language\r\n     * \r\n     * @param       {Object}  lang\r\n     * @param       {Object}  kbd\r\n     **/       \r\n    ui.addKeyboardToList = function(lang,kbd)\r\n    {\r\n      var found = ui.findListedKeyboard(lang);\r\n      if(found == null)\r\n      {\r\n        // Add the button \r\n        if(ui.listedKeyboards.length >= ui.maxListedKeyboards)\r\n        {\r\n          var oldestPriority = 0x7fffffff, oldestFound = null;\r\n          \r\n          for(var i = 0; i < ui.listedKeyboards.length; i++)\r\n            if(ui.listedKeyboards[i].priority < oldestPriority)\r\n            {\r\n              oldestFound = i;\r\n              oldestPriority = ui.listedKeyboards[i].priority;\r\n            }\r\n            \r\n          // delete the oldest used control\r\n          if(oldestFound != null)\r\n          {\r\n            var rk = ui.listedKeyboards[oldestFound];\r\n            ui.langKeyboardListNodes[rk.lang.id] = null;\r\n            ui.langKeyboardNodes[rk.lang.id] = null;\r\n            ui.languageButtonsNode.removeChild(rk.buttonNode);\r\n            if(oldestFound == 0)\r\n              ui.listedKeyboards = ui.listedKeyboards.slice(oldestFound + 1);\r\n            else if(oldestFound == ui.listedKeyboards.length - 1)\r\n              ui.listedKeyboards = ui.listedKeyboards.slice(0, oldestFound);\r\n            else\r\n              ui.listedKeyboards = ui.listedKeyboards.slice(0, oldestFound).concat(ui.listedKeyboards.slice(oldestFound+1));\r\n          }\r\n        }\r\n        var buttonNode = ui.createNode('div', null/*'kmw_button_keyboard_'+lang.id*/, 'kmw_button');\r\n        var aNode = ui.createNode('a', null, 'kmw_button_a'+(lang.keyboards.length>1 ? ' kmw_norightgap' : ''));\r\n        aNode.href='#';\r\n        \r\n        var p1=ui.ToolBar_Text['SelectKeyboardPre']+kbd['Name'],p2=ui.ToolBar_Text['SelectKeyboardSuf'];\r\n        if(p1.toLowerCase().indexOf(p2.toLowerCase()) < 0) p1=p1+' '+ p2;\r\n        aNode.title = p1;\r\n        aNode.onclick = function(event) { return ui.selectLanguage(event, lang) };\r\n        aNode.appendChild(ui.createNode('div', 'kmw_img_kbd', 'kmw_img'));\r\n        \r\n        ui.lgText=ui.truncate(lang.name,28);\r\n        aNode.appendChild(ui.createNode('div', null, 'kmw_a', ui.lgText));\r\n        buttonNode.appendChild(aNode);\r\n        \r\n        var thisANode = aNode;\r\n        \r\n        if(lang.keyboards.length > 1) { \r\n          aNode = ui.createNode('a', null, 'kmw_button_a kmw_noleftgap');\r\n          aNode.href = '#';\r\n          aNode.title = ui.ToolBar_Text['AltKeyboardsPre']+lang.name+ui.ToolBar_Text['AltKeyboardsSuf'];\r\n          aNode.onclick = function(event) { return ui.showKeyboardsForLanguage(event, lang) };\r\n          var divNode = ui.createNode('div', null, 'kmw_a');\r\n          var kbdText=ui.truncate(kbd['Name'].replace(/\\s?keyboard/i,''),40-ui.lgText.length);\r\n          divNode.appendChild(ui.langKeyboardNodes[lang.id] = ui.createNode('span', null, 'kmw_kbd', kbdText));\r\n          aNode.appendChild(divNode);\r\n          aNode.appendChild(ui.createNode('div', null, 'kmw_drop'));\r\n          buttonNode.appendChild(aNode);\r\n          \r\n          ui.langKeyboardListNodes[lang.id] = ui.createNode('ul', null, 'kmw_selector_kbd');\r\n          ui.langKeyboardListNodes[lang.id].style.display='none';\r\n          \r\n          for(var n in lang.keyboards) {\r\n            var itemNode = ui.createNode('li');\r\n            kbdText = lang.keyboards[n]['Name'].replace(/\\s?keyboard/i,'');\r\n            // We append the full BCP-47 code here for disambiguation when regional and/or script variants exist.\r\n            kbdText = kbdText + \" [\" + lang.keyboards[n].LanguageCode + \"]\";\r\n            aNode = ui.createNode('a', null, null, kbdText);\r\n            aNode.href = '#';\r\n            aNode.title = '';\r\n            aNode.onclick = (function(lang,kbd) { return function(event) { return ui.selectKeyboard(event, lang, kbd); } })(lang, lang.keyboards[n]);\r\n\r\n            itemNode.appendChild(aNode);\r\n            ui.langKeyboardListNodes[lang.id].appendChild(itemNode);\r\n          }\r\n          buttonNode.appendChild(ui.langKeyboardListNodes[lang.id]);\r\n        }\r\n        \r\n        ui.languageButtonsNode.appendChild(buttonNode);\r\n        \r\n        var thisLang = lang, thisButtonNode = buttonNode;\r\n        ui.listedKeyboards.push({priority: ui.keyboardListPriority++, lang:thisLang, keyboard:kbd, buttonNode:thisButtonNode, aNode:thisANode});\r\n      }\r\n      else\r\n      {    \r\n        ui.listedKeyboards[found].priority = ui.keyboardListPriority++;\r\n        ui.listedKeyboards[found].keyboard = kbd;\r\n        var e = ui.langKeyboardNodes[lang.id];\r\n        if(e) \r\n        {\r\n          var kbdText=kbd['Name'].replace(/\\s?keyboard/i,'');\r\n          e.innerHTML = ui.truncate(kbdText,40-ui.lgText.length);\r\n        }\r\n        if(ui.listedKeyboards[found].aNode) \r\n        {\r\n          var p1=ui.ToolBar_Text['SelectKeyboardPre']+kbd['Name'],p2=ui.ToolBar_Text['SelectKeyboardSuf'];\r\n          if(p1.toLowerCase().indexOf(p2.toLowerCase()) < 0) p1=p1+' '+ p2;\r\n          ui.listedKeyboards[found].aNode.title = p1;\r\n        }\r\n      }\r\n    }\r\n\r\n    /** \r\n     *  Truncate a long name and add an ellipsis\r\n     *  \r\n     *  @param  {string}  PName   string that may need to be truncated\r\n     *  @param  {number}  PLen    max non-truncated length\r\n     *  @return {string}          string, truncated with ellipsis if necessary\r\n     *                \r\n     **/\r\n    ui.truncate = function(PName,PLen)\r\n    {\r\n      if(PName.length <=PLen) return PName;\r\n      return PName.substr(0,PLen-1)+'\\u2026';\r\n    }\r\n        \r\n    /**\r\n     * Rebuild the entire keyboard list whenever a keyboard is installed \r\n     * (without necessarily loading the keyboard)\r\n     * \r\n     * @param       {Object}  p Keyboard metadata object\r\n     **/    \r\n    ui.registerKeyboard = function(p)\r\n    {\r\n      ui.updateMap = true; \r\n      if(ui.startTimer) clearTimeout(ui.startTimer);\r\n      ui.startTimer = setTimeout(ui.addKeyboardsToMap,2000);\r\n    }\r\n    keymanweb['addEventListener']('keyboardregistered',ui.registerKeyboard);   \r\n    \r\n    var keyboardsForLangPopup = null;\r\n    \r\n    /**\r\n     * Function     hideKeyboardsForLanguage\r\n     * Scope        Private\r\n     * @param       {Object}  event\r\n     * @return      {boolean} \r\n     * Description  Hide the list of keyboards for this language\r\n     **/    \r\n    ui.hideKeyboardsForLanguage = function(event)\r\n    {\r\n      var e = ui.keyboardsForLangPopup;\r\n      if(e) e.style.display='none';\r\n      ui.CancelPopupDismissal(ui.hideKeyboardsForLanguage);\r\n      return ui.eventCapture(event);\r\n    }\r\n\r\n    /**\r\n     * Display the list of keyboards for this language\r\n     * \r\n     * @param       {Object}  event\r\n     * @param       {Object}  lang\r\n     * @return      {boolean} \r\n     * \r\n     **/    \r\n    ui.showKeyboardsForLanguage = function(event, lang)\r\n    {\r\n      ui.hideKeyboardsPopup(event);\r\n      var e = ui.langKeyboardListNodes[lang.id];\r\n      if(e)\r\n      {\r\n        if(e.style.display=='block') return ui.hideKeyboardsForLanguage(event);\r\n        e.style.display='block';\r\n        ui.keyboardsForLangPopup = e;\r\n        ui.SetupPopupDismissal(e, ui.hideKeyboardsForLanguage);\r\n      }\r\n      return ui.eventCapture(event);\r\n    }\r\n      \r\n    /**\r\n     * Select the language, and either select the keyboard (if unique) or display the list of keyboards\r\n     * available for this language\r\n     * \r\n     * @param       {Object}  event\r\n     * @param       {Object}  lang   \r\n     * @return      {boolean} \r\n     **/    \r\n    ui.selectLanguage = function(event, lang)\r\n    {\r\n      var found=ui.findListedKeyboard(lang), kbd = null;\r\n\r\n      if(found == null)\r\n        kbd = lang.keyboards[0];\r\n      else\r\n        kbd = ui.listedKeyboards[found].keyboard;\r\n      if(!kbd) return false;\r\n\r\n      return ui.selectKeyboard(event,lang,kbd);\r\n    }\r\n\r\n    /**\r\n     * Enable a selected keyboard \r\n     * \r\n     * @param       {Object}  event\r\n     * @param       {Object}  lang\r\n     * @param       {Object}  kbd    \r\n     * @return      {boolean} \r\n     **/  \r\n    ui.selectKeyboard = function(event,lang,kbd)\r\n    {\r\n      if(ui.selectedLanguage)\r\n      {\r\n        var found = ui.findListedKeyboard(ui.selectedLanguage);\r\n        if(found != null) ui.listedKeyboards[found].buttonNode.className = 'kmw_button';\r\n      }\r\n      ui.offButtonNode.className = 'kmw_button';\r\n      ui.selectedLanguage = lang;\r\n      ui.selectedKeyboard = kbd;\r\n      ui.SelectedLanguage = lang.id; \r\n      // Return focus to input area and activate the selected keyboard \r\n      ui.setLastFocus(); //*****this seems out of sequence???\r\n      ui.addKeyboardToList(lang,kbd);\r\n      keymanweb['setActiveKeyboard'](kbd['InternalName'],lang.id);\r\n      ui.listedKeyboards[ui.findListedKeyboard(lang)].buttonNode.className = 'kmw_button_selected';\r\n    \r\n      // Always save current state when selecting a keyboard\r\n      ui.saveCookie();\r\n      ui.enableControls();\r\n      return ui.hideKeyboardsPopup(event) || ui.hideKeyboardsForLanguage(event);\r\n    }  \r\n\r\n    /**\r\n     * Enable all UI controls\r\n     * \r\n     * @return      {boolean} \r\n     **/    \r\n    ui.enableControls = function()\r\n    {\r\n      var elems=[ui.offButtonNode, ui.offBarNode, ui.oskButtonNode, ui.oskBarNode],hideOskButton=false;\r\n\r\n      if(keymanweb['isCJK'](ui.selectedKeyboard)) hideOskButton = true;\r\n      else if(ui.selectedKeyboard == null) hideOskButton = (elems[2].style.display == 'none')\r\n    \r\n      if(ui.selectedKeyboard != null || ui.listedKeyboards.length > 0)\r\n      {        \r\n        for(var i = 0; i < elems.length; i++) \r\n          elems[i].style.display='';\r\n      }\r\n      else\r\n      {\r\n        for(var i = 0; i < elems.length; i++) \r\n          elems[i].style.display='none';\r\n      }      \r\n\r\n      if(hideOskButton)\r\n        ui.oskButtonNode.style.display = ui.oskBarNode.style.display = 'none';\r\n\r\n      else if(ui.selectedKeyboard == null)\r\n        ui.oskButtonNode.className='kmw_button_disabled';\r\n      //else \r\n      //  ui.oskButtonNode.className=(osk && osk['isEnabled']() ? 'kmw_button_selected' : 'kmw_button');\r\n      \r\n      // Display the toolbar if still hidden\r\n      ui.toolbarNode.parentNode.style.visibility='visible';\r\n      return true;\r\n    }\r\n\r\n    /**\r\n     * Restore the focus to the last focused element\r\n     **/    \r\n    ui.setLastFocus = function()\r\n    {\r\n      keymanweb['focusLastActiveElement']();\r\n    }\r\n\r\n    /**\r\n     * Display or hide the OSK according to user control. This will always force \r\n     * the focus to the last active element if currently unfocused, which is  \r\n     * preferable to not having the OSK appear when the OSK button is clicked.      \r\n     * \r\n     * @param       {Object}  event\r\n     * @return      {boolean} \r\n     **/    \r\n    ui.showOSK = function(event)\r\n    { \r\n      //Toggle OSK on or off\r\n      if(osk && keymanweb['getActiveKeyboard']() != '')\r\n      {\r\n        if(osk['isEnabled']()) osk['hide'](); else osk['show'](true);      \r\n      }\r\n      ui.setLastFocus();\r\n      return ui.eventCapture(event);\r\n    }\r\n\r\n    /**\r\n     * Function     offButtonClickEvent\r\n     * Scope        Private\r\n     * @param       {Object}  event\r\n     * @return      {boolean} \r\n     * Description  Update the UI when all keyboards disabled by user\r\n     **/    \r\n    ui.offButtonClickEvent = function(event)\r\n    { \r\n      if(ui.toolbarNode.className != 'kmw_controls_disabled')\r\n      {\r\n        ui.hideKeyboardsForLanguage(null);\r\n        if(ui.selectedLanguage)\r\n        {\r\n          var found = ui.findListedKeyboard(ui.selectedLanguage);\r\n          if(found != null) ui.listedKeyboards[found].buttonNode.className = 'kmw_button';\r\n        }\r\n        ui.selectedKeyboard = null;\r\n        ui.selectedLanguage = null;\r\n        ui.SelectedLanguage = '';\r\n        ui.offButtonNode.className = 'kmw_button_selected';\r\n      }\r\n      // Return the focus to the input area and set the active keyboard to nothing\r\n      ui.setLastFocus();     \r\n      keymanweb['setActiveKeyboard']('','');\r\n      \r\n      //Save current state when deselecting a keyboard (may not be needed) \r\n      ui.saveCookie();\r\n      ui.enableControls();\r\n      return ui.eventCapture(event);\r\n    }\r\n\r\n    /**\r\n     * Function     eventCapture\r\n     * Scope        Private\r\n     * @param       {Object}  event\r\n     * @return      {boolean} \r\n     * Description  Browser-independent event capture\r\n     **/    \r\n    ui.eventCapture = function(event)\r\n    {\r\n      if(!event) event = window.event;\r\n      if(window.event) window.event.returnValue = false;\r\n      if(event) event.cancelBubble = true;\r\n      \r\n      return false;\r\n    }\r\n        \r\n    /**\r\n     * Function     selectRegion\r\n     * Scope        Private\r\n     * @param       {Object}  event\r\n     * @param       {string}  region   \r\n     * @return      {boolean} \r\n     * Description  Select the region for which to list languages\r\n     **/    \r\n    ui.selectRegion = function(event, region)\r\n    {                     \r\n      var e = ui.browseMapNode;\r\n      if(!e) return ui.eventCapture(event);\r\n      e.className = 'kmw_browsemap_'+region;      \r\n      if(typeof(ui.regionLanguageListNodes[region]) == 'undefined') \r\n      {\r\n        ui.updateMap = true; ui.addKeyboardsToMap();\r\n      }\r\n      ui.regionLanguageListNodes[region].style.display='block';\r\n      ui.regionNodes[region].className='selected';\r\n      if(ui.selectedRegion != null && ui.selectedRegion != region)\r\n      {\r\n        ui.regionLanguageListNodes[ui.selectedRegion].style.display='none';\r\n        ui.regionNodes[ui.selectedRegion].className='';\r\n      }\r\n      ui.selectedRegion = region;\r\n      //ui.saveCookie();\r\n      return ui.eventCapture(event);\r\n    }\r\n\r\n    /**\r\n     * Function     unhoverRegion\r\n     * Scope        Private\r\n     * @param       {Object}  event\r\n     * @param       {string}  region   \r\n     * @return      {boolean} \r\n     * Description  Remove highlighting from a region\r\n     **/    \r\n    ui.unhoverRegion = function(event, region)\r\n    {\r\n      ui.browseMapNode.className = (ui.selectedRegion == null ? '' : 'kmw_browsemap_'+ui.selectedRegion);\r\n      ui.regionNodes[region].className=(ui.selectedRegion==region?'selected':'');\r\n      return ui.eventCapture(event);\r\n    }\r\n      \r\n    /**\r\n     * Function     hoverRegion\r\n     * Scope        Private\r\n     * @param       {Object}  event\r\n     * @param       {string}  region \r\n     * @return      {boolean} \r\n     * Description  Highlight a hovered region\r\n     **/    \r\n    ui.hoverRegion = function(event, region)\r\n    {\r\n      ui.browseMapNode.className = 'kmw_browsemap_'+region+'_sel';\r\n      ui.regionNodes[region].className='hover';\r\n      return ui.eventCapture(event);\r\n    }\r\n    \r\n    /**\r\n     * Function     pluck\r\n     * Scope        Private\r\n     * @param       {Object}  elem\r\n     * @param       {string}  property   \r\n     * @return      {*} \r\n     * Description  Get the value of an element property\r\n     **/    \r\n    ui.pluck = function(elem, property) {\r\n        return elem.getAttribute ? elem.getAttribute(property) || elem[property] : elem[property];\r\n      };\r\n\r\n    /**\r\n     * Function     focusControlEvent\r\n     * Scope        Private\r\n     * @param       {Object}  params    Object containing Target element (or frame)\r\n     * @return      {boolean}   \r\n     * Description  UI code to be executed on receiving focus\r\n     */\r\n    ui.focusControlEvent = function(params)\r\n    {      \r\n      if(!ui.init) return true;\r\n\r\n      var t=params.target;      \r\n      if(t.tagName.toLowerCase() == 'textarea' || (t.tagName.toLowerCase() == 'input' && t.type.toLowerCase() == 'text'))\r\n      {\r\n        ui.lastActiveControl = t;\r\n        if(ui.pluck(t, 'kmw_disable'))\r\n        {\r\n          if(ui.toolbarNode.className != 'kmw_controls_disabled')\r\n            ui.toolbarNode.className = 'kmw_controls_disabled';\r\n        }\r\n        else\r\n        {\r\n          if(ui.selectedKeyboard != null)\r\n          {\r\n            if(keymanweb['isCJK']()) \r\n            {\r\n              ui.oskButtonNode.style.display = ui.oskBarNode.style.display = 'none';\r\n            }\r\n            else\r\n            {\r\n              ui.oskButtonNode.className = (osk && osk['isEnabled']()) ? 'kmw_button_selected' : 'kmw_button';\r\n            }\r\n          }\r\n            \r\n          if(ui.toolbarNode.className != '') ui.toolbarNode.className = '';\r\n          \r\n          var offsetX, offsetY;\r\n          if(t.KMW_HelpOffsetX) offsetX = t.KMW_HelpOffsetX; else offsetX = 64;\r\n          if(t.KMW_HelpOffsetY) offsetY = t.KMW_HelpOffsetY; else offsetY = 0;\r\n          ui.helpOffsetX = util['getAbsoluteX'](t)+offsetX;\r\n          ui.helpOffsetY = util['getAbsoluteY'](t)+t.offsetHeight+offsetY;          \r\n        }\r\n      }   \r\n      return true;\r\n    }\r\n    keymanweb['addEventListener']('controlfocused',ui.focusControlEvent);\r\n  \r\n    /**\r\n     * Function     oncontrolblurred\r\n     * Scope        Private\r\n     * Parameters   {Object}  params  Object containing event\r\n     * @return      {boolean}\r\n     * Description  UI code to be executed on losing focus \r\n     */  \r\n    ui.blurControlEvent = function(params)\r\n    {\r\n      if(!ui.init) return true;\r\n\r\n      // Must disable OSK button when not focused\r\n      if(ui.oskButtonNode.style.display != 'none') ui.oskButtonNode.className='kmw_button_disabled';\r\n      \r\n      if(!params.event) return true;   // I2404 - Manage IE events in IFRAMEs      \r\n      return true;\r\n    }\r\n    keymanweb['addEventListener']('controlblurred',ui.blurControlEvent);\r\n\r\n\r\n    /**\r\n     * UI action required when keyboard changed indirectly\r\n     * \r\n     * @param       {Object}  p   keyboard selection object\r\n     * @return      {boolean}   \r\n     **/    \r\n    ui.changeKeyboardEvent = function(p)\r\n    {                   \r\n      //if(p['indirect']) \r\n      //{          \r\n        var kbName=p['internalName'],\r\n            lgName=p['languageCode'];\r\n        if(lgName != '' && kbName != '')\r\n        {\r\n          var lg = ui.languages[lgName];\r\n          if(lg != null)\r\n          {\r\n            for(var j=0; j<lg.keyboards.length; j++)\r\n            {\r\n              if(lg.keyboards[j]['InternalName'] == kbName)\r\n              {\r\n                ui.selectKeyboard(null, lg, lg.keyboards[j]);\r\n                window.focus(); ui.setLastFocus();                       \r\n              }\r\n            }\r\n          }\r\n        }\r\n      //}\r\n      return true;\r\n    }\r\n    keymanweb['addEventListener']('keyboardchange',ui.changeKeyboardEvent);\r\n\r\n\r\n    /**\r\n     * UI action when OSK displayed: restore to or update the saved OSK position\r\n     * \r\n     * @param       {Object}  oskPosition\r\n     * @return      {Object} \r\n     **/    \r\n    ui.onShowOSK = function(oskPosition)\r\n    { \r\n      if(ui.init) ui.oskButtonNode.className = 'kmw_button_selected';\r\n      //The return valu is not currently useful, but allows for the possibility of the OSK restricting or limiting\r\n      //a UI-set position, and returning the corrected position to the UI\r\n      return oskPosition;\r\n    } \r\n    osk['addEventListener']('show',ui.onShowOSK);\r\n\r\n    /**\r\n     * Update appearance of OSK button whenever the OSK is hidden by the user\r\n     * \r\n     * @param       {Object}  p\r\n     **/    \r\n    ui.onHideOSK = function(p)\r\n    {\r\n      if(ui.init && p['HiddenByUser']) ui.oskButtonNode.className = 'kmw_button';\r\n    }  \r\n    osk['addEventListener']('hide',ui.onHideOSK);\r\n    \r\n    /**\r\n     * Function     showKeyboardsPopup\r\n     * Scope        Private\r\n     * @param       {Object}  event\r\n     * @return      {boolean} \r\n     * Description  Update the map when displayed\r\n     **/    \r\n    ui.showKeyboardsPopup = function(event)\r\n    {                 \r\n      // Add any newly available keyboards to the map\r\n      ui.addKeyboardsToMap();\r\n      \r\n      if(ui.toolbarNode.className == 'kmw_controls_disabled') return ui.eventCapture(event);\r\n      ui.hideKeyboardsForLanguage(null);\r\n      if(ui.selectorNode.className=='kmw_over') return ui.hideKeyboardsPopup(event);\r\n      ui.selectorNode.className='kmw_over';\r\n      ui.keyboardsButtonNode.className='kmw_button_selected';\r\n      \r\n      ui.SetupPopupDismissal(ui.selectorNode, ui.hideKeyboardsPopup);\r\n      return ui.eventCapture(event);\r\n    }\r\n\r\n    /**\r\n     * Function     hideKeyboardsPopup\r\n     * Scope        Private\r\n     * @param       {Object}  event\r\n     * @return      {boolean} \r\n     * Description  Hide the list of keyboards for this language\r\n     **/    \r\n    ui.hideKeyboardsPopup = function(event)\r\n    {\r\n      ui.selectorNode.className='';\r\n      ui.keyboardsButtonNode.className='kmw_button';\r\n      ui.CancelPopupDismissal(ui.hideKeyboardsPopup);\r\n      return ui.eventCapture(event);\r\n    }\r\n    \r\n    /**\r\n     * Hide both language and keyboard selection popups on body click\r\n     * @param   {Object}  event\r\n     * @return  {boolean}      \r\n    **/       \r\n    ui.hideAllPopups = function(event)\r\n    {\r\n      var e = ui.keyboardsForLangPopup;\r\n      if((!e || (e.style.display =='none')) && (ui.selectorNode.className == '')) return true;\r\n      ui.hideKeyboardsPopup(event);\r\n      ui.hideKeyboardsForLanguage(event);\r\n      return ui.eventCapture(event);    \r\n    }\r\n      \r\n    var dismissalCallback = null, popupElement = null, lastDismissalCallback = null;\r\n    \r\n    /**\r\n     * Function     PopupDismissal\r\n     * Scope        Private\r\n     * @param       {Object}  event\r\n     * @return      {Object} \r\n     * Description  Carry out action when popup dismissed\r\n     **/    \r\n    ui.PopupDismissal = function(event)\r\n    {               \r\n      var t = (event && event.target) || (window.event && window.event.srcElement);\r\n      if(t)\r\n      {            \r\n        while(t.parentNode)\r\n        {\r\n          if (t == popupElement) return null;\r\n          t = t.parentNode;\r\n        }\r\n      }    \r\n      if(t.nodeName == '#document') ui.hideAllPopups(event); //KMEW-41, fixed for build 356.\r\n      return dismissalCallback;\r\n    }\r\n    \r\n    /**\r\n     * Function     SetupPopupDismissal\r\n     * Scope        Private\r\n     * @param       {Object}            element    \r\n     * @param       {function(Object)}  callback\r\n     * Description  Prepare for callback dismissal\r\n     **/    \r\n    ui.SetupPopupDismissal = function(element, callback)\r\n    {\r\n      if(ui.PopupDismissal == document.onclick)\r\n        ui.CancelPopupDismissal(dismissalCallback);\r\n      dismissalCallback = callback;\r\n      popupElement = element;\r\n      lastDismissalCallback = document.onclick;\r\n      document.onclick = ui.PopupDismissal;\r\n    }\r\n    \r\n    /**\r\n     * Function     CancelPopupDismissal\r\n     * Scope        Private\r\n     * @param       {?function(Object)}  callback\r\n     * Description  Cancel callback dismissal\r\n     **/    \r\n    ui.CancelPopupDismissal = function(callback)\r\n    {\r\n      if(ui.PopupDismissal == document.onclick)\r\n      {\r\n        document.onclick = lastDismissalCallback;\r\n        lastDismissalCallback = null;\r\n        dismissalCallback = null;\r\n        popupElement = null;\r\n      }\r\n    }\r\n    \r\n    /**\r\n     * Load the previous state from the KeymanWeb_Keyboard and KeymanWeb_Toolbar cookies\r\n     **/\r\n    ui.loadCookie = function()\r\n    {\r\n      var currentKeyboard='',currentLgCode='',c=util['loadCookie'](\"KeymanWeb_Keyboard\");          \r\n      if(c['current'] != undefined) currentKeyboard = c['current'].split(':')[0];\r\n      c=util['loadCookie'](\"KeymanWeb_Toolbar\"); \r\n\r\n      if(c['region'] != undefined) ui.selectedRegion = c['region'];\r\n      if(c['maxrecent'] != undefined)\r\n      {\r\n        for(var i=0; i<c['maxrecent']; i++)\r\n        {\r\n          if(c['recent'+i] != undefined)    \r\n          { \r\n            var r=c['recent'+i].split(',');\r\n            if(r.length == 2)\r\n            {\r\n              var k = ui.languages[r[0]];\r\n              if(k != null)\r\n              {\r\n                for(var j=0; j<k.keyboards.length; j++)\r\n                {\r\n                  if(k.keyboards[j]['InternalName'] == r[1])\r\n                  {\r\n                    ui.addKeyboardToList(k, k.keyboards[j]);\r\n                    if(k.keyboards[j]['InternalName'] == currentKeyboard)\r\n                    { \r\n                      ui.selectKeyboard(null, k, k.keyboards[j]);\r\n                      window.focus(); ui.setLastFocus();\r\n                      break;                      \r\n                    }  \r\n                    break;\r\n                  }\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      }\r\n      // If language list and keyboard list have not yet been saved as a cookie, \r\n      // initialize to the current (default) language and keyboard, if set by KMW \r\n      else\r\n      {\r\n        var kbName=keymanweb['getActiveKeyboard'](),\r\n            lgName=keymanweb['getActiveLanguage']();\r\n        if(lgName != '' && kbName != '')\r\n        {\r\n          var lg = ui.languages[lgName];\r\n          if(lg != null)\r\n          {\r\n            for(var j=0; j<lg.keyboards.length; j++)\r\n            {\r\n              if(lg.keyboards[j]['InternalName'] == kbName)\r\n              {\r\n                ui.selectKeyboard(null, lg, lg.keyboards[j]);\r\n                window.focus(); ui.setLastFocus();                       \r\n              }\r\n            }\r\n          }\r\n        }\r\n      }\r\n    }\r\n\r\n    /**\r\n     * Save the current UI state in the KeymanWeb_Toolbar cookie\r\n     **/  \r\n    ui.saveCookie = function()\r\n    {\r\n      var vs={};\r\n      vs['region'] = ui.selectedRegion;\r\n      vs['maxrecent'] = ''+ui.listedKeyboards.length; \r\n      for(var i=0; i<ui.listedKeyboards.length; i++)\r\n        vs['recent'+i] = ui.listedKeyboards[i].lang.id+\",\"+ui.listedKeyboards[i].keyboard['InternalName'];\r\n      util['saveCookie']('KeymanWeb_Toolbar',vs);\r\n    }\r\n\r\n    // Initialize when everything defined (replaces unreliable onload event handler)\r\n    // ui.initToolbarUI(); \r\n    // No, initialization must not be done before KMW is ready!\r\n    // ui.initialize() is now called by keymanweb when document is ready and kmw initialization completed\r\n      \r\n  } catch(ex){}\r\n}"]}